<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>mypage_message_send_send_massage</title>
<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
	integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
	crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
	integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
	crossorigin="anonymous"></script>
<script
	src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
	integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
	crossorigin="anonymous"></script>
<script
	src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
	integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
	crossorigin="anonymous"></script>
<style>
body {
	background-color: rgb(224, 224, 224);
}
</style>
</head>

<body>
	<!-- 보낸 쪽지함 상세보기 -->
	<div th:replace="/user/includes/header :: header"></div>
	<!--  윗부분 시작 //////////////////////////////////////// -->

	<div class="container"
		style="margin-top: 25px; margin-bottom: 25px; padding: 0px; background-color: white; height: 950px; width: 900px;">
		<a href="/mypage/mypage_Message_From_Board.do">
			<button type="button" class="btn btn-secondary"
				style="height: 110px; position: relative; left: -74px; border-radius: 15px 0px 0px 15px; background-color: rgb(190, 190, 190); border-color: rgb(190, 190, 190);">
				<span>받은<br> 쪽지함
				</span>
			</button>
		</a> <a href="/mypage/mypage_Message_Send_Board.do">
			<button type="button" class="btn btn-secondary"
				style="height: 110px; position: relative; left: -152px; bottom: -110px; border-radius: 15px 0px 0px 15px;">
				<span>보낸<br> 쪽지함
				</span>
			</button>
		</a> <br />
		<div class="row" style="position: relative; top: -90px;">
			<div class="col-md-2" style="padding: 0px 0px 0px 30px;">
				<img src="/resources/images/img/message.jpg" alt=""
					style="height: 45px;"> &nbsp; <span
					style="font-size: x-large;"> <b>쪽지함</b>
				</span>
			</div>
			<div class="col-md-4"></div>
		
			<div class="col-md-6" style="text-align: right;">
			<button type="submit" id="sendBtn" class="btn btn-primary" style="width: 90px;">보내기</button>
				&nbsp; &nbsp;


			</div>

		</div>


		<hr
			style="border: solid 2px rgb(224, 224, 224); margin-top: 5px; margin-bottom: 10px; width: 96%; position: relative; top: -90px;" />


			<form action="sendMessage.do">
			<div class="row"
				style="margin: 0px 20px 10px 20px; position: relative; top: -90px;">
				<div class="col-md-2"
					style="place-self: flex-end; text-align: center;">

					<span style="font-size: large;"> <b>받는 사람</b>
					</span>
				</div>
				<div class="col-md-10" style="align-self: center;">
					<input type="text" name="m_to" id="m_to" />
				</div>
			</div>

			<hr
				style="border: solid 1px rgb(224, 224, 224); margin-top: 5px; margin-bottom: 10px; width: 96%; position: relative; top: -90px;" />
			<!-- 여기부터 데이터 시작~~~~~~~////////////////////// -->
			<!-- 여기부터 데이터 시작~~~~~~~////////////////////// -->


			<!-- 여기까지 더미데이터 끝 -->

			<div class="row"
				style="margin: 20px 30px 0px 30px; position: relative; top: -90px;">
				<textarea name="msg" id="msg" cols="30" rows="10" style="width: 100%"
					placeholder="내용을 입력해주세요"></textarea>
			</div>
		</form>
	</div>
	<!--  윗부분 끝 //////////////////////////////////////// -->


	<div th:replace="/user/includes/footer :: footer"></div>


	<script type="text/javascript">
		$(document).ready(function() {
			connect();
			$('#sendBtn').click(function() { 
				console.log("하이욤")
				send(); 
				//form태그 이동..
			});
		})
		
		var wsocket;
		
		function connect() {
			wsocket = new WebSocket("ws://192.168.0.2:8001/messageSocket.do");
			wsocket.onopen = onOpen;
			wsocket.onmessage = onMessage;
			wsocket.onclose = onClose;
		}
		function disconnect() {
			wsocket.close();
		}
		
		function onOpen(evt) {
			console.log("onOpen(evt)");
		}
		
		function onMessage(evt) {
			/* console.log("evt :" + evt);
			var data = evt.data;
			appendMessage(data); */
		}
		
		function onClose(evt) {
		}
		
		function send() {
			let m_to = $('#m_to').val();
			
			let msg = $('#msg').val();
			
			wsocket.send(m_to + "," + msg);
			$('#m_to').val("");
			$('#msg').val("");
		}

		//자기 자신한테 보냈을때 실행
		function appendMessage(msg) {
			console.log(msg);
			alert("msg : " + msg);
		}
		
	</script> 

</body>


</html>